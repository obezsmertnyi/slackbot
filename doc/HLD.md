# Архітектура системи (HLD)

### 1. Призначення системи
Система призначена для автоматизованого розгортання нових версій доданків у різних середовищах {dev, qa, stage, prod} кластеру Kubernetes за допомогою команд у Slackbot та нотифікаціями усіх етапів у канал.

### 2. Опис роботи системи

З вказаними вище середовищами система працює наступним чином:
- у `dev` середовище система розгортає повністю автоматично при кожному комміті у гілку `develop`. При цьому результат цього процесу повертається у попередньо налаштований Slack-канал.
Весь цей процес проходить узгоджено з даними про версію доданку у БД (запускається лише тоді, коли встановлена неактуальна версія)
- у `{qa, stage, prod}` розробник може послідовно у кожне наступне середовище розгорнути актуальну версію доданку за допомогою команди `/promote {dev, qa, stage, prod} {app_name}`. Умова виконання команди: успішне розгортання у попередньому оточенні.
- отримати список усіх розгорнутих версій в усіх наявних оточеннях кластеру конкретного аплікейшену розробник може командою `/diff {app_name}`
- у разі неуспішного розгортання версії розробник може повернутися до попередньої командою `/rollback {dev, qa, stage, prod} {app_name}`

### 3. Функціональна схема
![HLD_Slackbot](https://github.com/sbazanov/InfiniteLoopBreakers/blob/main/doc/HLD_Slackbot.jpg)

Архітектура системи має наступні компоненти:

- kubernetes cluster з 4-ма відокремленими ns: {dev, qa, stage, prod}
- Slackbot app у зв'язці зі своєю локальною базою
- GitOps система Flux
- GH Repo та Helm сharts додатку 
- GH Container Registry
- GH Actions  у якості CI/CD системи
